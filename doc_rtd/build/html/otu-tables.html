<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Description of pipeline OTU tables &#8212; amplicon_sequencing_pipeline_doc  documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Source code" href="source-code.html" />
    <link rel="prev" title="Pipeline output files and directories" href="output.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="description-of-pipeline-otu-tables">
<h1>Description of pipeline OTU tables<a class="headerlink" href="#description-of-pipeline-otu-tables" title="Permalink to this headline">¶</a></h1>
<div class="section" id="otu-calling">
<h2>OTU calling<a class="headerlink" href="#otu-calling" title="Permalink to this headline">¶</a></h2>
<p>The pipeline produces various OTU tables. All tables are constructed
from the set of raw dereplicated reads. These are a set of reads in
FASTA format that appear in the file <code class="docutils literal"><span class="pre">datasetID.raw_dereplicated.fasta</span></code>
and correspond to the set of unique sequences present in the raw data.</p>
<a class="reference internal image-reference" href="_images/OTU_calling.png"><img alt="Schematic of OTU calling pipeline." src="_images/OTU_calling.png" style="width: 80%;" /></a>
<div class="section" id="de-novo-otu-tables">
<h3><em>de novo</em> OTU tables<a class="headerlink" href="#de-novo-otu-tables" title="Permalink to this headline">¶</a></h3>
<p>The dereplicated reads are clustered to within the specified sequence
similarity percentage cut-off (<code class="docutils literal"><span class="pre">OTU_SIMILARITY</span></code>, default: 97) using
usearch. Individual reads are assigned either as the OTU centroid or as
a match by usearch&#8217;s output. Centroids are labeled as <code class="docutils literal"><span class="pre">OTU_ID.0</span></code> and matches count from
<code class="docutils literal"><span class="pre">OTU_ID.1</span></code> onwards. These are separate &#8220;oligotypes&#8221; within the OTU
<code class="docutils literal"><span class="pre">OTU_ID</span></code>. These are written out to an oligotype table in
<code class="docutils literal"><span class="pre">datasetID.otu_table.*.denovo_oligotypes</span></code>.
Note that this definition of &#8216;oligotype&#8217; is simply the unique sequences within
each OTU cluster.</p>
<p>All oligotype counts are then collapsed to their respective parent
OTU, resulting in a fully <em>de novo</em> OTU table which can be found in the
filename <code class="docutils literal"><span class="pre">datasetID.otu_table.*.denovo</span> <span class="pre">where</span></code> <code class="docutils literal"><span class="pre">*</span></code> gets replaced by the
OTU similarity cut-off.</p>
</div>
<div class="section" id="distribution-based-otu-tables">
<h3>Distribution-based OTU tables<a class="headerlink" href="#distribution-based-otu-tables" title="Permalink to this headline">¶</a></h3>
<p>A counts table is made from the dereplicated reads and dereplication
map. The counts table and dereplicated reads are used as inputs to
<code class="docutils literal"><span class="pre">dbotu.py</span></code>&#8216;s <code class="docutils literal"><span class="pre">call_otus()</span></code> function. Briefly, sequences are
compared against existing OTU representative sequences in descending
abundance order. If the candidate sequence’s abundance is within the
<code class="docutils literal"><span class="pre">ABUNDANCE_CRITERIA</span></code> of an existing OTU and its count distribution
across samples is not significantly different from the OTU’s, then the
candidate sequence is grouped with that OTU. You can learn more about
the distribution-based clustering algorithm at
<code class="docutils literal"><span class="pre">http://almlab.mit.edu/dbotu3.html</span></code>.</p>
<p>Intermediate files such as the membership file (which lists which
sequences belong to which OTU) and the table of sequence counts (used as
an input to the <code class="docutils literal"><span class="pre">dbotu.py</span></code> function call) are in the respective
<code class="docutils literal"><span class="pre">/home/ubuntu/proc/</span></code> folder for your dataset.</p>
</div>
<div class="section" id="closed-reference-otu-table">
<h3>Closed-reference OTU table<a class="headerlink" href="#closed-reference-otu-table" title="Permalink to this headline">¶</a></h3>
<p>There are two types of database-referencing that are outputed from the
pipeline by default. The first is assignments from the Ribosomal
Database Project (RDP), which returns probabilistic assignments. The
default probability cut-off below which an assignment is labeled as
unidentified at a given taxonomic level is 0.5, but this can be set
using a summary file parameter <code class="docutils literal"><span class="pre">RDP_CUTOFF</span></code>. This OTU table can be found
in the results sub-folder called <code class="docutils literal"><span class="pre">RDP</span></code>. The full classifications can be
found in <code class="docutils literal"><span class="pre">/home/ubuntu/proc/</span></code>, in <code class="docutils literal"><span class="pre">RDP_classifications.denovo.txt</span></code>
or <code class="docutils literal"><span class="pre">RDP_classifications.dbOTU.txt</span></code>.</p>
<p>The dereplicated reads are also aligned to a standard database
(GreenGenes in the case of 16S sequences and UNITE in the case of ITS
sequences). In the case of GreenGenes, the database is determined based
on the specified OTU similarity cut-off: e.g. <code class="docutils literal"><span class="pre">97_otus.fasta</span></code> for
<code class="docutils literal"><span class="pre">OTU_SIMILARITY</span></code> set to 97). The alignment is performed using usearch,
and considers the top 10 hits. Consensus assignments are then produced
for the top 1, top 3, top 5 and top 10 hits (where a taxonomic level is
only assigned a latin name if the top N hits from GreenGenes agree), and
the corresponding OTU tables are output. Thus, the OTU table called
<code class="docutils literal"><span class="pre">datasetID.otu_table.*.gg.consensus10</span></code> contains latin names which are
formed from a minimum consensus of the top 10 hits for each taxonomic
level, where ’*’ gets replaced by the OTU similarity cut-off. Levels are
left unidentified (e.g. <code class="docutils literal"><span class="pre">s__</span></code>) if the consensus requirement is not
met.</p>
<p>Note that the database referencing process is one of the slower steps in
the pipeline, so if you only care about RDP, you can skip the GreenGenes
assignments steps by setting the parameter <code class="docutils literal"><span class="pre">GG_ALIGN</span></code> to False in the
summary file. Similarly, for ITS sequences, you can skip the UNITE
assignments steps by setting the parameter <code class="docutils literal"><span class="pre">UNITE_ALIGN</span></code> to False.</p>
</div>
<div class="section" id="open-reference-otu-table">
<h3>Open-reference OTU table<a class="headerlink" href="#open-reference-otu-table" title="Permalink to this headline">¶</a></h3>
<p><strong>DEPRECATED: The pipeline no longer produces open-reference OTUs.</strong></p>
<p>If any reads in the dereplicated sequences do not align to
GreenGenes/UNITE to within the specified similarity cut-off, they are
clustered with the desired similarity cut-off using usearch, and
appended to the GreenGenes/UNITE closed-reference table to produce a
full, open-reference OTU table (which combines GreenGenes-referenced and
<em>de novo</em> OTUs) at the desired similarity cut-off, with filename
<code class="docutils literal"><span class="pre">datasetID.otu_table.gg.*.open_ref</span></code>.</p>
</div>
</div>
<div class="section" id="intermediate-files">
<h2>Intermediate Files<a class="headerlink" href="#intermediate-files" title="Permalink to this headline">¶</a></h2>
<p>A description of the potentially useful intermediate files that you
can find in <code class="docutils literal"><span class="pre">~/proc/</span></code>. TODO.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Description of pipeline OTU tables</a><ul>
<li><a class="reference internal" href="#otu-calling">OTU calling</a><ul>
<li><a class="reference internal" href="#de-novo-otu-tables"><em>de novo</em> OTU tables</a></li>
<li><a class="reference internal" href="#distribution-based-otu-tables">Distribution-based OTU tables</a></li>
<li><a class="reference internal" href="#closed-reference-otu-table">Closed-reference OTU table</a></li>
<li><a class="reference internal" href="#open-reference-otu-table">Open-reference OTU table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#intermediate-files">Intermediate Files</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="output.html" title="previous chapter">Pipeline output files and directories</a></li>
      <li>Next: <a href="source-code.html" title="next chapter">Source code</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/otu-tables.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Thomas Gurry and Claire Duvallet.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/otu-tables.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>